<div class="advanced-filter" [class.advanced-filter--embedded]="embedded">
  <div class="advanced-filter__content">
    <div class="advanced-filter__date">
      <div class="advanced-filter__date__quick">
        <ng-container *ngFor="let df of dateFilters">
            <span class="advanced-filter__date__quick__item"
                  [class.advanced-filter__date__quick__item--active]="df.selected"
                  (click)="setActiveDate(df.start, df.end)">{{df.label | translate}}</span>
        </ng-container>
      </div>
      <div class="advanced-filter__date__range">
        <div class="datepicker--custom" [class.datepicker-visible]="datepickerVisible">
          <div (showDaterangepicker)="datepickerVisible = true" (hideDaterangepicker)="datepickerVisible = false" (selected)="dateSelected($event)" daterangepicker>
            <div class="advanced-filter__date__range__input" name="daterange" >
                <span>{{'ADVANCEDFILTER_FROM' | translate}} <span class="advanced-filter__date__range__input__value">{{ startDate.format('MMM D, YYYY') }}</span>
                      {{'ADVANCEDFILTER_TO' | translate}} <span class="advanced-filter__date__range__input__value">{{ endDate.format('MMM D, YYYY') }}</span>
                </span> <mat-icon>keyboard_arrow_down</mat-icon> </div>
          </div>
        </div>
      </div>
    </div>

    <ng-container *ngIf="!embedded">
      <div *ngIf="groupByEnabled" class="advanced-filter__group-by">
        <dropdown-component [options]="groupByFilters" [selected]="groupBy" [placeholder]="'ADVANCEDFILTER_GROUPBY' | translate" (onSelect)="groupBy = $event"></dropdown-component>
      </div>

      <div class="advanced-filter__query" [class.advanced-filter__query--no-group-by]="!groupByEnabled">
        <div class="advanced-filter__query__input" [class.advanced-filter__query__input--advanced]="advanced">
          <mat-input-container>
            <input matInput placeholder="{{'ADVANCEDFILTER_FILTERS' | translate}}" [value]="currentFilterTerm" (input)="filterTermInput($event)" (blur)="filterTermInputBlur()" (focus)="filterTermInputFocus()">
            <div matPrefix class="advanced-filter__query__input__prefix">
              <div *ngFor="let filterTerm of filterTerms" class="advanced-filter__query__input__prefix__item">
                <div class="advanced-filter__query__input__prefix__item__image" [style.background]="colors[filterTerm.type] || '#F16C00'">{{filterTerm.type.substring(0,1).toUpperCase()}}</div>
                <div class="advanced-filter__query__input__prefix__item__text">{{filterTerm.label}}</div>
                <mat-icon class="advanced-filter__query__input__prefix__item__close" (click)="removeFilterTerm(filterTerm)">close</mat-icon>
              </div>

              <div class="advanced-filter__query__suggestions">
                <div class="advanced-filter__query__suggestions__item" *ngFor="let suggestion of filterSearchResults" (click)="addFilterTerm(suggestion)">
                  <div class="advanced-filter__query__suggestions__item__image">{{suggestion.type.substring(0,1).toUpperCase()}}</div>
                  <div class="advanced-filter__query__suggestions__item__text">{{suggestion.label}}</div>
                </div>
              </div>
            </div>
          </mat-input-container>
        </div>
      </div>

      <div class="advanced-filter__icons">
        <mat-icon class="refresh-icon" (click)="refresh()" matTooltip="{{refreshText | translate}} {{refreshValue}}" mdTooltipPosition="left">refresh</mat-icon>
        <share-link [shareUrl]="shareUrl"></share-link>
        <mat-icon *ngIf="hasMenu" [matMenuTriggerFor]="advancedOptions">more_vert</mat-icon>
        <mat-menu #advancedOptions="matMenu" x-position="before">
          <button mat-menu-item (click)="toggleAdvanced()"> {{(advanced ? 'ADVANCEDFILTER_HIDE' : 'ADVANCEDFILTER_SHOW') | translate}} </button>
        </mat-menu>
      </div>
    </ng-container>

  </div>

  <ng-container *ngIf="!embedded">
    <div class="advanced-filter__advanced" [class.advanced-filter__advanced--inactive]="!advanced" [class.advanced-filter__advanced--overflow-visible]="visible">
      <div class="advanced-filter__advanced__row">

        <div class="advanced-filter__advanced__row--flex">
          <input-autocomplete [title]="'ADVANCEDFILTER_CAMPAIGN' | translate" [entityType]="'campaign'" (selected)="addFilterTerm($event)"></input-autocomplete>
          <input-autocomplete [title]="'ADVANCEDFILTER_AFFILIATE' | translate" [entityType]="'affiliate'" (selected)="addFilterTerm($event)"></input-autocomplete>
        </div>

        <div class="advanced-filter__advanced__row--flex">
          <input-autocomplete [title]="'ADVANCEDFILTER_PRODUCTSCHEDULE' | translate" [entityType]="'productschedule'" (selected)="addFilterTerm($event)"></input-autocomplete>
          <div>
            <mat-input-container>
              <input matInput class="advanced-filter__advanced__small" placeholder="{{'ADVANCEDFILTER_SUBID1' | translate}}">
            </mat-input-container>

            <mat-input-container>
              <input matInput class="advanced-filter__advanced__small" placeholder="{{'ADVANCEDFILTER_SUBID2' | translate}}">
            </mat-input-container>

            <mat-input-container>
              <input matInput class="advanced-filter__advanced__small" placeholder="{{'ADVANCEDFILTER_SUBID3' | translate}}">
            </mat-input-container>
          </div>
        </div>

        <div class="advanced-filter__advanced__row--flex">
          <input-autocomplete [title]="'ADVANCEDFILTER_MERCHANTPROVIDER' | translate" [entityType]="'merchantprocessor'" (selected)="addFilterTerm($event)"></input-autocomplete>

          <div>
            <mat-input-container>
              <input matInput class="advanced-filter__advanced__small" placeholder="{{'ADVANCEDFILTER_SUBID4' | translate}}">
            </mat-input-container>

            <mat-input-container>
              <input matInput class="advanced-filter__advanced__small" placeholder="{{'ADVANCEDFILTER_SUBID5' | translate}}">
            </mat-input-container>
          </div>
        </div>

        <div class="advanced-filter__advanced__row--flex">
          <div class="advanced-filter__advanced__dropdown">
            <span class="unselected" [matMenuTriggerFor]="transactionTypeMenu">
              {{'ADVANCEDFILTER_TRANSACTIONTYPE' | translate}}
              <mat-icon>keyboard_arrow_down</mat-icon>
            </span>
          </div>
          <mat-menu #transactionTypeMenu="matMenu" x-position="after">
            <button mat-menu-item *ngFor="let tt of transactionTypes" (click)="addFilterTerm(tt)"> {{tt.label | translate}} </button>
          </mat-menu>

          <div class="advanced-filter__advanced__dropdown">
            <span class="unselected" [matMenuTriggerFor]="processorResultMenu">
              {{'ADVANCEDFILTER_PROCESSORRESPONSE' | translate}}
              <mat-icon>keyboard_arrow_down</mat-icon>
            </span>
          </div>
          <mat-menu #processorResultMenu="matMenu" x-position="after">
            <button mat-menu-item *ngFor="let pr of processorResponses" (click)="addFilterTerm(pr)"> {{pr.label | translate}} </button>
          </mat-menu>
        </div>
      </div>
    </div>

    <div *ngIf="advanced" class="advanced-filter__advanced-button">
      <span *ngIf="advanced" (click)="apply()">{{'ADVANCEDFILTER_APPLY' | translate}}</span>
      <span *ngIf="showResetButton()" (click)="reset()">{{'ADVANCEDFILTER_RESET' | translate}}</span>
      <span *ngIf="advanced" (click)="toggleAdvanced()">{{'ADVANCEDFILTER_CLOSE' | translate}}</span>
    </div>
  </ng-container>

</div>
