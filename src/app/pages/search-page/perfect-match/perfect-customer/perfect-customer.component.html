<div class="perfect-entity">

  <div *ngIf="customer; else spin">
    <div class="perfect-entity__info">
      <div class="perfect-entity__info__title">Shipping Address</div>

      <div class="perfect-entity__info__fields">

        <div class="perfect-entity__info__fields__item">
          <span class="perfect-entity__info__fields__item__label">Name:</span>
          <span class="perfect-entity__info__fields__item__value">{{customer.firstName + ' ' + customer.lastName}}</span>
        </div>

        <div class="perfect-entity__info__fields__item">
          <span class="perfect-entity__info__fields__item__label">City:</span>
          <span class="perfect-entity__info__fields__item__value">{{customer.address.city}}</span>
        </div>

        <div class="perfect-entity__info__fields__item">
          <span class="perfect-entity__info__fields__item__label">Address 1:</span>
          <span class="perfect-entity__info__fields__item__value">{{customer.address.line1}}</span>
        </div>

        <div class="perfect-entity__info__fields__item">
          <span class="perfect-entity__info__fields__item__label">State:</span>
          <span class="perfect-entity__info__fields__item__value">{{customer.address.state}}</span>
        </div>

        <div class="perfect-entity__info__fields__item">
          <span class="perfect-entity__info__fields__item__label">Address 2:</span>
          <span class="perfect-entity__info__fields__item__value">{{customer.address.line2}}</span>
        </div>

        <div class="perfect-entity__info__fields__item">
          <span class="perfect-entity__info__fields__item__label">Country:</span>
          <span class="perfect-entity__info__fields__item__value">{{customer.address.country}}</span>
        </div>

        <div class="perfect-entity__info__fields__item">
          <span class="perfect-entity__info__fields__item__label">ZIP Code:</span>
          <span class="perfect-entity__info__fields__item__value">{{customer.address.zip}}</span>
        </div>
      </div>
    </div>


      <div class="perfect-entity__table" *ngIf="!transactionsLoading; else spinTransactions">
        <div class="perfect-entity__table__title">Recent transactions</div>

        <server-error-message (refresh)="refreshTransactions()" *ngIf="transactionsServerError; else transactionsData;"></server-error-message>
        <ng-template #transactionsData>
          <table class="highlight">
            <thead>
              <tr>
                <th>Alias</th>
                <th class="cell--align-right">Amount</th>
                <th>Processor Response</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let transaction of transactions" [routerLink]="['/transactions', transaction.id]">
                <td>{{transaction.alias}}</td>
                <td class="cell--align-right">{{transaction.amount.usd()}}</td>
                <td>{{transaction.processorResponse.message}}</td>
              </tr>
            </tbody>
          </table>
        </ng-template>

      </div>

      <ng-template #spinTransactions>
        <table-loader></table-loader>
      </ng-template>

    <div class="perfect-entity__list">
      <div *ngFor="let ccard of customer.creditCards" class="perfect-entity__list__item">
        <img src="/assets/images/credit-card-notification.svg">
        <span class="perfect-entity__list__item__last">{{ccard.getType() | uppercase}} {{ccard.ccnumber | creditCardFormat}}</span>
        <span class="perfect-entity__list__item__expiration">{{ccard.expiration}}</span>
        <md-icon [routerLink]="['/creditcards', ccard.id]">visibility</md-icon>
      </div>
    </div>
  </div>

  <ng-template #spin><table-loader [rowHeight]="30"></table-loader></ng-template>
</div>
