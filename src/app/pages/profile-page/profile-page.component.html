<div class="entity-view">
  <div class="entity-view__title">{{'PROFILE_TITLE' | translate}}</div>

  <div (click)="navigation.back()" class="entity-view__change-mode"><md-icon>reply</md-icon></div>

  <div *ngIf="user">
    <div class="entity-view__info">
      <div class="entity-view__info__image entity-view__info__image--profile">
        <img src="{{ user.picture }}" alt="">
      </div>
      <div class="entity-view__info__data">
        <div class="entity-view__info__data__date">{{'PROFILE_CREATED' | translate}}: {{user.createdAt | formatDateTime}}</div>
        <div class="entity-view__info__data__name">{{user.name}}</div>
        <div class="entity-view__info__data__other">
          <span *ngIf="phone" class="entity-view__info__data__other__item"><md-icon>phone</md-icon>{{phone}}</span>
          <span class="entity-view__info__data__other__item"><md-icon>email</md-icon>{{user.email}}</span>
        </div>
      </div>
    </div>

    <tab-header [elements]="tabHeaders" [selectedIndex]="selectedIndex" (select)="setIndex($event)"></tab-header>

    <div class="profile-page__content">
      <md-tab-group [(selectedIndex)]="selectedIndex">
        <md-tab>
          <div *ngIf="userSettings" class="profile-page__content__general">
            <div class="profile-page__content__general__title">
              <div class="profile-page__content__general__title__main">{{'PROFILE_DETAILS_TITLE' | translate}}</div>
              <div class="profile-page__content__general__title__sub">{{'PROFILE_DETAILS_SUBTITLE' | translate}}</div>
              <!--<md-icon>more_vert</md-icon>-->
            </div>

            <div class="profile-page__content__general__data">
              <md-input placeholder="{{'PROFILE_DETAILS_FIRSTNAME' | translate}}" [(ngModel)]="userBackup.firstName"></md-input>
              <md-input placeholder="{{'PROFILE_DETAILS_LASTNAME' | translate}}" [(ngModel)]="userBackup.lastName"></md-input>
              <md-input-container>
                <input md-input placeholder="{{'PROFILE_DETAILS_WORKPHONE' | translate}}" type="text" [textMask]="{mask: mask, guide: false}" [(ngModel)]="userSettingsBackup.workPhone">
              </md-input-container>
              <md-input-container>
                <input md-input placeholder="{{'PROFILE_DETAILS_CELLPHONE' | translate}}" type="text" [textMask]="{mask: mask, guide: false}" [(ngModel)]="userSettingsBackup.cellPhone">
              </md-input-container>
              <div class="profile-page__content__general__data__dropdown">
                <autocomplete-input
                  [initialValue]="userSettingsBackup.timezone"
                  [options]="timezones"
                  [placeholder]="'PROFILE_DETAILS_TIMEZONE' | translate"
                  (selected)="userSettingsBackup.timezone = $event">
                </autocomplete-input>
              </div>

              <md-input placeholder="{{'PROFILE_DETAILS_EMAIL' | translate}}" [value]="user.email"></md-input>

              <div class="profile-page__content__general__data__dropdown">

                <autocomplete-input
                  [initialValue]="userSettingsBackup.language || 'English'"
                  [options]="['English', 'French']"
                  [placeholder]="'PROFILE_DETAILS_LANGUAGE' | translate"
                  (selected)="setLanguage($event)">
                </autocomplete-input>
              </div>
            </div>

            <div class="profile-page__content__general__button" (click)="updateUserDetails()">{{'PROFILE_DETAILS_UPDATE' | translate}}</div>
          </div>
        </md-tab>

        <md-tab>
          <div class="profile-page__content__notifications">
            <div class="profile-page__content__notifications__item">
              <div class="profile-page__content__notifications__title">
                <div class="profile-page__content__notifications__title__main">{{'PROFILE_NOTIFICATIONS_TITLE' | translate}}</div>
                <div class="profile-page__content__notifications__title__sub">{{'PROFILE_NOTIFICATIONS_SUBTITLE' | translate}}</div>
              </div>

              <div *ngIf="userSettings" class="profile-page__content__notifications__body profile-page__content__notifications__body--toggles">
                <md-checkbox
                  *ngFor="let settings of userSettings.notificationSettings"
                  [(ngModel)]="settings.receive"
                  (change)="userSettingsFieldUpdated()"
                  [color]="'primary'">{{deviceLabels[settings.name]}}</md-checkbox>
              </div>
            </div>
            <div class="profile-page__content__notifications__item">
              <div class="profile-page__content__notifications__title">
                <div class="profile-page__content__notifications__title__main">{{'PROFILE_NOTIFICATIONS_DEVICES_TITLE' | translate}}</div>
                <div class="profile-page__content__notifications__title__sub">{{'PROFILE_NOTIFICATIONS_DEVICES_SUBTITLE' | translate}}</div>
                <!--<md-icon>more_vert</md-icon>-->
              </div>

              <div class="profile-page__content__notifications__body">
                <md-input-container>
                  <input md-input placeholder="{{'PROFILE_NOTIFICATIONS_DEVICES_SMS' | translate}}" type="text" (blur)="userSettingsFieldUpdated()" [textMask]="{mask: mask, guide: false}" [(ngModel)]="getNotificationUserSettings('sms').data">
                </md-input-container>
                <md-input placeholder="{{'PROFILE_NOTIFICATIONS_DEVICES_EMAIL' | translate}}" (blur)="userSettingsFieldUpdated()" [(ngModel)]="getNotificationUserSettings('email').data"></md-input>
                <md-input placeholder="{{'PROFILE_NOTIFICATIONS_DEVICES_SKYPE' | translate}}" (blur)="userSettingsFieldUpdated()" [(ngModel)]="getNotificationUserSettings('skype').data"></md-input>
                <md-input placeholder="{{'PROFILE_NOTIFICATIONS_DEVICES_SLACK' | translate}}" (blur)="userSettingsFieldUpdated()" [(ngModel)]="getNotificationUserSettings('slack').data"></md-input>
              </div>
            </div>
            <div class="profile-page__content__notifications__item">
              <div class="profile-page__content__notifications__title">
                <div class="profile-page__content__notifications__title__main">{{'PROFILE_NOTIFICATIONS_SETTINGS_TITLE' | translate}}</div>
                <div class="profile-page__content__notifications__title__sub">{{'PROFILE_NOTIFICATIONS_SETTINGS_SUBTITLE' | translate}}</div>
                <!--<md-icon>more_vert</md-icon>-->
              </div>

              <div class="profile-page__content__notifications__body">
                <table class="highlight">
                  <tbody *ngIf="notificationSettings && notificationSettings.settings">
                    <ng-container *ngFor="let group of notificationSettings.settings.notification_groups">
                      <tr *ngFor="let notification of group.notifications">
                        <td>{{notification.name}}</td>
                        <td><md-checkbox [color]="'primary'" (change)="notificationSettingsFieldUpdated()" [(ngModel)]="notification.default"></md-checkbox></td>
                      </tr>
                    </ng-container>
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <div class="card-outside-button" (click)="sendTestNotification()">{{'PROFILE_NOTIFICATIONS_TESTNOTIFICATION' | translate}}</div>
          <div class="card-outside-button" (click)="sendTestAlert()">{{'PROFILE_NOTIFICATIONS_TESTALERT' | translate}}</div>

        </md-tab>

        <md-tab>
          <table-memory
            class="accounts-table"
            [data]="accounts"
            [columnParams]="accountColumnParams"
            [associationEnabled]="false"
            [dissociationEnabled]="false"
            (view)="viewAccount($event)"
            [textOptions]="accountTextOptions">
          </table-memory>
        </md-tab>

        <md-tab>
          <user-signing-strings></user-signing-strings>
        </md-tab>
      </md-tab-group>
    </div>
  </div>
</div>

