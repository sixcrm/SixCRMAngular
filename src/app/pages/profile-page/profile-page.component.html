<div class="entity-view">
  <div class="entity-view__title">User Profile</div>

  <div (click)="navigation.back()" class="entity-view__change-mode"><md-icon>reply</md-icon></div>

  <div *ngIf="user">
    <div class="entity-view__info">
      <div class="entity-view__info__image entity-view__info__image--profile">
        <img src="{{ user.picture }}" alt="">
      </div>
      <div class="entity-view__info__data">
        <div class="entity-view__info__data__date">Created: {{user.createdAt | formatDateTime}}</div>
        <div class="entity-view__info__data__name">{{user.name}}</div>
        <div class="entity-view__info__data__other">
          <span *ngIf="phone" class="entity-view__info__data__other__item"><md-icon>phone</md-icon>{{phone}}</span>
          <span class="entity-view__info__data__other__item"><md-icon>email</md-icon>{{user.email}}</span>
        </div>
      </div>
    </div>

    <div class="entity-view__navigation">
      <span class="entity-view__navigation__label" [class.entity-view__navigation__label--active]="selectedIndex===0" (click)="setIndex(0)">GENERAL DETAILS</span>
      <span class="entity-view__navigation__label" [class.entity-view__navigation__label--active]="selectedIndex===1" (click)="setIndex(1)">NOTIFICATIONS</span>
      <span class="entity-view__navigation__label" [class.entity-view__navigation__label--active]="selectedIndex===2" (click)="setIndex(2)">ACCOUNTS</span>
    </div>

    <div class="profile-page__content">
      <md-tab-group [(selectedIndex)]="selectedIndex">
        <md-tab>
          <div *ngIf="userSettings" class="profile-page__content__general">
            <div class="profile-page__content__general__title">
              <div class="profile-page__content__general__title__main">Profile</div>
              <div class="profile-page__content__general__title__sub">general information</div>
              <!--<md-icon>more_vert</md-icon>-->
            </div>

            <div class="profile-page__content__general__data">
              <md-input placeholder="First name" [(ngModel)]="userBackup.firstName"></md-input>
              <md-input placeholder="Last name" [(ngModel)]="userBackup.lastName"></md-input>
              <md-input-container>
                <input md-input placeholder="Work phone" type="text" [textMask]="{mask: mask, guide: false}" [(ngModel)]="userSettingsBackup.workPhone">
              </md-input-container>
              <md-input-container>
                <input md-input placeholder="Cell phone" type="text" [textMask]="{mask: mask, guide: false}" [(ngModel)]="userSettingsBackup.cellPhone">
              </md-input-container>
              <div class="profile-page__content__general__data__dropdown">
                <autocomplete-input
                  [initialValue]="userSettingsBackup.timezone"
                  [options]="timezones"
                  [placeholder]="'Set Timezone'"
                  (selected)="userSettingsBackup.timezone = $event">
                </autocomplete-input>
              </div>

              <md-input placeholder="Email" [value]="user.email"></md-input>

              <div class="profile-page__content__general__data__dropdown">

                <autocomplete-input
                  [initialValue]="'English'"
                  [options]="['English']"
                  [placeholder]="'Select Language'"
                  (selected)="setLanguage($event)">
                </autocomplete-input>
              </div>
            </div>

            <div class="profile-page__content__general__button" (click)="updateUserDetails()">Update</div>
          </div>
        </md-tab>

        <md-tab>
          <div class="profile-page__content__notifications">
            <div class="profile-page__content__notifications__item">
              <div class="profile-page__content__notifications__title">
                <div class="profile-page__content__notifications__title__main">Notification Toggle</div>
                <div class="profile-page__content__notifications__title__sub">Toggle on/off when you receive notifications</div>
              </div>

              <div *ngIf="userSettings" class="profile-page__content__notifications__body profile-page__content__notifications__body--toggles">
                <md-checkbox
                  *ngFor="let settings of userSettings.notificationSettings"
                  [(ngModel)]="settings.receive"
                  (change)="userSettingsFieldUpdated()"
                  [color]="'primary'">{{deviceLabels[settings.name]}}</md-checkbox>
              </div>
            </div>
            <div class="profile-page__content__notifications__item">
              <div class="profile-page__content__notifications__title">
                <div class="profile-page__content__notifications__title__main">Devices</div>
                <div class="profile-page__content__notifications__title__sub">Setup devices for notifications</div>
                <!--<md-icon>more_vert</md-icon>-->
              </div>

              <div class="profile-page__content__notifications__body">
                <md-input-container>
                  <input md-input placeholder="SMS number" type="text" (blur)="userSettingsFieldUpdated()" [textMask]="{mask: mask, guide: false}" [(ngModel)]="getNotificationUserSettings('sms').data">
                </md-input-container>
                <md-input placeholder="Email" (blur)="userSettingsFieldUpdated()" [(ngModel)]="getNotificationUserSettings('email').data"></md-input>
                <md-input placeholder="Skype" (blur)="userSettingsFieldUpdated()" [(ngModel)]="getNotificationUserSettings('skype').data"></md-input>
                <md-input placeholder="Slack web hook" (blur)="userSettingsFieldUpdated()" [(ngModel)]="getNotificationUserSettings('slack').data"></md-input>
              </div>
            </div>
            <div class="profile-page__content__notifications__item">
              <div class="profile-page__content__notifications__title">
                <div class="profile-page__content__notifications__title__main">Notification settings</div>
                <div class="profile-page__content__notifications__title__sub">Select what notifications you want to receive</div>
                <!--<md-icon>more_vert</md-icon>-->
              </div>

              <div class="profile-page__content__notifications__body">
                <table class="highlight">
                  <tbody *ngIf="notificationSettings && notificationSettings.settings">
                    <ng-container *ngFor="let group of notificationSettings.settings.notification_groups">
                      <tr *ngFor="let notification of group.notifications">
                        <td>{{notification.name}}</td>
                        <td><md-checkbox [color]="'primary'" (change)="notificationSettingsFieldUpdated()" [(ngModel)]="notification.default"></md-checkbox></td>
                      </tr>
                    </ng-container>
                  </tbody>
                </table>
              </div>
            </div>
          </div>

          <div class="card-outside-button" (click)="sendTestNotification()">Send test notification</div>
          <div class="card-outside-button" (click)="sendTestAlert()">Send test alert</div>

        </md-tab>

        <md-tab>
          <table-memory
            class="accounts-table"
            [data]="accounts"
            [columnParams]="accountColumnParams"
            [associationEnabled]="false"
            [dissociationEnabled]="false"
            (view)="viewAccount($event)"
            [title]="'Account'">
          </table-memory>
        </md-tab>
      </md-tab-group>
    </div>
  </div>
</div>

