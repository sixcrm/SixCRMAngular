<div class="state-machine-details__container">
  <div class="state-machine-details__info">
    <div *ngIf="queue.loaded" class="state-machine-details__info__count">{{queue.count}}</div>
    <div *ngIf="!queue.loaded" class="placeholder placeholder--large"></div>

    <div class="state-machine-details__info__title">
      {{'ORDERENGINE_DETAILS_TITLE' | translate}} <span style="text-transform: capitalize">{{queue.labelkey | translate}}</span>
    </div>

    <div class="state-machine-details__info__details">
      <div class="state-machine-details__info__details__box">
        <div class="item-title">{{'ORDERENGINE_DETAILS_AVGTIME' | translate}}</div>
        <div class="value-container">
          <div *ngIf="queue.loaded" class="item-value">{{queue.avgTimeInSeconds | formatDuration}}</div>
          <div *ngIf="!queue.loaded" class="placeholder placeholder--small"></div>
          <div class="arrow"
               [style.border-bottom-color]="queue.avgTimeColor || 'rgba(0,0,0,0.3)'"
               [style.transform]="(queue.avgTimeColor === 'RED' || queue.avgTimeColor == 'ORANGE') ? 'rotate(180deg)' : 'rotate(0)'">
          </div>
        </div>
      </div>

      <div class="state-machine-details__info__details__box">
        <div class="item-title">{{'ORDERENGINE_DETAILS_FAILURERATE' | translate}}</div>
        <div class="value-container">
          <div *ngIf="queue.loaded" class="item-value">{{queue.failureRate}}%</div>
          <div *ngIf="!queue.loaded" class="placeholder placeholder--small"></div>

          <div class="arrow"
               [style.border-bottom-color]="queue.failureColor || 'rgba(0,0,0,0.3)'"
               [style.transform]="(queue.failureColor === 'RED' || queue.failureColor == 'ORANGE') ? 'rotate(180deg)' : 'rotate(0)'">
          </div>
        </div>
      </div>
    </div>

    <div class="state-machine-details__info__description">
      {{queue.description}}
    </div>

    <div *ngIf="!standalone; else downstream" class="state-machine-details__info__button" [routerLink]="[queue.label.toLowerCase()]">{{'ORDERENGINE_DETAILS_VIEW' | translate}}</div>
    <ng-template #downstream>
      <ng-container *ngIf="queue.downstreamQueues && queue.downstreamQueues.length > 0">
        <div class="state-machine-details__info__downstream">
          <div class="state-machine-details__info__downstream__text">{{'ORDERENGINE_DETAILS_DOWNSTREAM' | translate}}</div>
          <div *ngFor="let d of queue.downstreamQueues"
               class="state-machine-details__info__button state-machine-details__info__button--downstream"
               [routerLink]="['/state-machine', d.toLowerCase()]">
            {{d}}
          </div>
        </div>
      </ng-container>
    </ng-template>
    <div *ngIf="standalone && enableLivePolling" class="state-machine-details__polling" (click)="togglePolling.emit(!isPolling)">
      <md-icon>{{isPolling ? 'pause_circle_outline' : 'play_circle_outline'}}</md-icon>
      <span> {{isPolling ? 'PAUSE' : 'START'}} {{'ORDERENGINE_DETAILS_LIVEPOLLING' | translate}}</span>
    </div>
  </div>

  <div class="state-machine-details__timeseries">
    <advanced-filter
      [date]="date"
      [embedded]="true"
      (dateChanged)="dateChanged.emit($event)">
    </advanced-filter>
    <state-machine-details-chart [timeseries]="timeseries" [date]="date"></state-machine-details-chart>
  </div>
</div>
